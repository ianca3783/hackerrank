import scrapy
from datetime import datetime

# scrapy crawl quotes -o products.csv

class QuotesSpider(scrapy.Spider):

    custom_settings = {
        'FEED_FORMAT': 'csv',
        'FEED_URI': 'new_products.csv'
    }

    rate = 1
    start_urls = []
    name = "quotes"
    mfrpns = ['ct1028k3',
'hu7197x',
'hu7262x',
'c35154',
'pu825x',
'pfc105',
'gdb1330',
'cuk2939',
'038198119a',
'wk8533x',
'03l131512dq',
'7701477028',
'g052195m4',
'5w30',
'ct1139k2',
'6161',
'071115562c',
'03l115562',
'hu7008z',
'1k0129620d',
'g052182a2',
'03l198119f',
'w71252',
'600001700',
'pu9362x',
'w753',
'hu7162x',
'83212365933',
'600001600',
'7701477024',
'gdb1386',
'gdb1550',
'w71275',
'703141410',
'cu2939',
'3c0127434',
'03l198119',
'6q6955707c',
'gdb400',
'hu7181k',
'c37153',
'02e305051c',
'8200768927',
'ct957k1',
'g052195m2',
'13327811227',
'w71930',
'11318570649',
'1k0698451j',
'7700274177',
'10w40',
'038198051c',
'ct1134k1',
'04l121011l',
'03l131512cf',
'74115562',
'2735005',
'036198119e',
'1386037',
'3c0698151c',
'ct1051k1',
'wk5002x',
'5w40',
'hu820x',
'jts483',
'c30130',
'hu71151x',
'03l121011j',
'c43121',
'p999g12',
'6pk1050',
'1359941',
'3b9955985a',
'1417010997',
'd1s',
'5q0127177',
'c151051',
'ct1028k4',
'38198119',
'165467674r',
'gdb1622',
'1k1819653b',
'jts370',
'38145215',
'pfb450',
'pu9361x',
'v',
'7n0127177b',
'hu7020z',
'c26168',
'w79',
'28538389',
'c161341',
'hu722x',
'03l129711ag',
'wk8201',
'11428507683',
'1k0698451g',
'g052516a2',
'83222305396',
'03g903137b',
'pu8013z',
'03l121011g',
'13527797906',
'7701476745',
'344459',
'7701478031',
'wk512',
'1987302804',
'03l121011p',
'44121113',
'1k0121113a',
'wk93913',
'1j0821021',
'8e0199379bf',
'130c11508r',
'600001300',
'6pk1070',
'ct1168k1',
'03l129711e',
'ct1044k1',
'hu7010z',
'13528589971',
'cuk2862',
'045121011h',
'1k6827505f9b9',
'3c0698151j',
'6dpk1195',
'8200277960',
'cr2032',
'038103385a',
'pu723x',
'stingator',
'117203694r',
'1k0411315k',
'210107477r',
'3c0698451f',
'5pk1432',
'04l198119a',
'545011362r',
'03l198119e',
'03n115562',
'164039594r',
'cu2882',
'038145209q',
'7701478830',
'8k0698151f',
'8t0127401a',
'13712246997',
'wk5001',
'11318586699',
'130c17529r',
'1j0615423b',
'p551',
'03g198119',
'1j0127401a',
'6001549973',
'c32338',
'wht000228',
'03l198119d',
'8e0615423',
'c271921',
'hu7215x',
'wk6003',
'1j0698151g',
'gdb1307',
'hu6004x',
'pfb401',
'6r0615301',
'8k0698451a',
'gdb1515',
'152089599r',
'66140',
'hu6122x',
'03g115281f',
'1k0949101',
'wk692',
'11517805811',
'164002137r',
'410602192r',
'c14130',
'pu80081',
'w7008',
'03l903137t',
'13527797905',
'6001547140',
'6001549906',
'6q6955435d',
'p999',
'302055852r',
'p569',
'wk7301',
'038198119e',
'11427802114',
'7701477517',
'83222289720',
'hu710x',
'manusi',
'n91084501',
'p565',
'1k0698151f',
'545004269r',
'5q0129620b',
'802417',
'g052145s2',
'13046071842',
'3d1837015ap',
'antigel',
'130c13191r',
'1848220',
'3397118979',
'8k0615301',
'a001989680313',
'c30005',
'1k0615601ab',
'3c0998281b',
'6001549971',
'713610610',
'7701478018',
'11237805696',
'1k0615424j',
'1t0598611b',
'g052171a2',
'hu7128x',
'spray',
'11427787697',
'1t0498621',
'302050453r',
'3c0853600amqh',
'1j0411314t',
'1t0827574l',
'2290601009',
'600000600',
'83222409710',
'ct1092k1',
'n10106402',
'wd40',
'1787829',
'1k0127434b',
'a000989940213alee',
'g052512a2',
'11427807177',
'6001546789',
'hu7214x',
'p550',
'1685861',
'1k0498203',
'1k0819644b',
'1k0955453s',
'6001546788',
'c30138',
'cu2545',
'cuk26009',
'g004000m2',
'038103469ae',
'11317797514',
'1343796',
'3b1837461',
'600004000',
'ct1051k2',
'hu8201y',
'06a260849c',
'12230035934',
'1j0615601n',
'24118612901',
'534016410',
'7h0127401b',
'1k0412331b',
'1k0498621',
'535001210',
'8200257642',
'8e0698151k',
'c32130',
'gdb1351',
'gdb1763',
'11317797898',
'210101832r',
'335808',
'34216774692',
'4g0698151aa',
'6pk1200',
'6pk976',
'802270',
'ct1028',
'038109309c',
'11317797899',
'1u0853621cmel',
'3397118933',
'3721',
'7711130071',
'a0009899701baa4',
'cu3054',
'p662',
'036145933h',
'038103483d',
'038903315an',
'1087087',
'11417797896',
'1k0407182',
'600015800',
'a2303570182',
'a6420940000',
'wk84213',
'03c109158a',
'03l198119c',
'13046028202',
'13046028802',
'13528573159',
'13528580559',
'21207565745',
'410605536r',
'cuk2450',
'gdb1583',
'hu7114x',
'jbj100',
'06a115561b',
'1c0945511ardw',
'1j0412331c',
'1k0825237ag',
'8e0943021b',
'ct1078k1',
'd2s',
'g052180a2',
'wk8571',
'12218591724',
'13046071172',
'1j0807217cgru',
'1j0827566l',
'1k0615423j',
'24012501581',
'255400337r',
'4f5827505d',
'6pk1548',
'c29985x',
'hu821x',
'w81180',
'11417798019',
'1k0598611',
'272104377r',
'3c0615404e',
'410602581r',
'8200768913',
'8383',
'df2803',
'03g903315c',
'1471854',
'1479837',
'1k1423055m',
'1z9945097c',
'3c0821022',
'6001546685',
'gdb1698',
'pu9001x',
'wht000232',
'11237823191',
'1354953',
'1940182',
'1j0698451p',
'1j0805903bb41',
'410607115r',
'7701066680',
'7701208252',
'8j1837015a',
'03g105266bm',
'03n115562b',
'10730269',
'13327793672',
'1343792',
'1376484',
'1j0129620',
'1k0615123e',
'1k6827505e9b9',
'333741',
'4b0698151j',
'64319313519',
'66340',
'7700500168',
'8d0863821q',
'g060162a2',
'gau052195m2',
'03l115389c',
'03l128063t',
'06a198119',
'11427788460',
'1717510',
'1j3959857a',
'1k0199231j',
'3397008006',
'3b0941015an',
'3b1837015aq',
'4b0615301b',
'a000989940211alee',
'c32191',
'trusa',
'0248l1',
'38117070',
'03l130519',
'03l198119b',
'04l121011e',
'1088179',
'11127799224',
'1j0615301m',
'6001999716',
'6pk1715',
'6pk1750',
'6q0698151',
'a0009899701',
'ct975k3',
'jte1135',
'lx1211',
'n10591608',
'wht000884',
'wk82018',
'038103469ad',
'38971600',
'03l903137a',
'06b121687',
'0aw301516h',
'117205191r',
'1j0907660c',
'302058324r',
'34116761244',
'3b1837015ap',
'3c0615403e',
'4pk855',
'713610020',
'8200744753',
'8e0199382ag',
'cuk2882',
'df4464s',
'jts393',
'pu8021',
'wk84211',
'wk8422',
'04l121011ex',
'13271191',
'1457070008',
'203102452',
'546114237r',
'6001550443',
'6001997196',
'6pk1660',
'6y0807221e',
'df2805',
'p732x',
'pfc105e',
'w9050',
'wk69',
'03l105266de',
'03l121011b',
'06a919501a',
'1j0615424b',
'1k0498203a',
'3c0821021',
'51247204367',
'6001550441',
'7701039565',
'7701070525',
'7701470783',
'8e0615424',
'c27105',
'g052162a2',
'038103603n',
'12237786869',
'1321517',
'1j6943021b',
'2290602004',
'302050901r',
'420020910',
'443955465',
'5pk1750',
'6y0821101a',
'ct1105k3',
'g055175a2',
'hu7131x',
'rc1695',
'sm1714',
'38121473',
'3990158022',
'03g198119b',
'1109ay',
'13717795284',
'13717797465',
'1883037',
'1k0615301ak',
'1k0949102',
'24422061',
'2682',
'3397118936',
'34116794429',
'3d1837016ac',
'3u0853621bmel',
'497610324r',
'4a0615601a',
'545001225r',
'64210',
'6pk2260',
'713644070',
'97223186',
'ct908k1',
'cuk2440',
'n10566103',
'25048',
'03g145276',
'059919501a',
'11717810871',
'13717800151',
'152095084r',
'1f0129620',
'1k0127434a',
'1k1819669',
'34216862202',
'3c0145117f',
'4h0498625a',
'64210nlhcb',
'6pk1613',
'6pk2080',
'6x1837013h',
'7701207823',
'8200575641',
'850101031s',
'colier',
'ct1178k1',
'ct914k1',
'g060726a2',
'hu70041x',
'hu7126x',
'hu7203x',
'038903137t',
'03g131512ad',
'059963319m',
'1547953',
'1672144',
'1808479',
'1942003',
'1k0611763e',
'34116852253',
'3c0413031at',
'6001550442',
'6q0411315n',
'7701471866',
'a1402770095',
'a6110170060',
'adblue',
'c51001',
'freon',
'g052143a2',
'03l131501k',
'1201255',
'1j0407181',
'1k0698151a',
'2696',
'3aa698451',
'3c0199231d',
'3c1837015a',
'5pk1212',
'6q0945511',
'8k0133843l',
'a0009899701baa6',
'fbx100',
'gdb1668',
'vopsea',
'w6103',
'wht000227',
'wk691',
'038903315ah',
'03l115389h',
'03l903137',
'59130519',
'1j0809961a',
'3397118977',
'543a06915r',
'5q0819653',
'7701205812',
'apadistilata',
'c26721',
'c30135',
'ct983k1',
'cu2440',
'cuk29005',
'cuk8430',
'gdb1288',
'jbj804',
'rh1156',
'w672',
'wk7202x',
'wk8232',
'03g115281d',
'03l121011c',
'069131547d',
'101000033aa',
'1432205',
'1677302',
'1689148',
'1883046',
'1h0819644b',
'1j0615424h',
'1k0615601ac',
'302052617r',
'7l0839015d',
'8200257684',
'8200785044',
'8386',
'850108569s',
'8e0943022b',
'8gj002525131',
'ct1077k2',
'hu920x',
'jts484',
'n10579805',
'wk84221x',
'038103085c',
'038103638k',
'1101464',
'1920qk',
'1k6821022a',
'1t0827505j9b9',
'2184',
'230574',
'28239294',
'3397007297',
'34116851269',
'34356791958',
'3b4839015al',
'3b4839016al',
'3b5943021e',
'3d0943021a',
'534001410',
'5p0955707b',
'600014400',
'8200744754',
'8201464598',
'83222365987',
'98069842',
'c27107',
'g052529a2',
'hu7181z',
'wk8424',
'036131503m',
'036198119c',
'038109101r',
'038117070a',
'038903315c',
'1322152',
'1478337',
'1496240',
'2640',
'31122343353',
'34356789445',
'4502331',
'510007310',
'5k0698151',
'6q0201051j',
'83290429576',
'8e0615301q',
'8gh007157121',
'c36014',
'cr2025',
'jar928',
'wk82016',
'wk85311',
'wp1144',
'02e398029b',
'1336180',
'1494057',
'1j0413031s',
'1j0422803h',
'1k0505465k',
'2180',
'2691',
'34116858047',
'3b1837462',
'402060010r',
'415040110',
'6y0898167e',
'6y1837461',
'713611000',
'c151431',
'c301254',
'cuk2545',
'g052910a4',
'g060175a2',
'wk82017',
'038131501al',
'03g115281e',
'03g141016a',
'057130764h',
'888080846',
'117202495r',
'1400196',
'166001137r',
'1709013',
'1j0422811b',
'1j0498625',
'1z0949102d',
'2677401',
'34116780711',
'34351164371',
'34356791962',
'3b7601171xrw',
'55589549',
'7701207677',
'8201153808',
'915400',
'a6398200056',
'cu2757',
'hu6011z',
'hu8005z',
'jte1136',
'p999g13',
'trusamedicala',
'032905106b',
'036103464g',
'03g103385a',
'03l131501g',
'11272389',
'11717787870',
'1201837',
'1233683',
'1478338',
'190195',
'1j0825237m',
'1k6827505c',
'1t0853601eulm',
'1z0821105a',
'320003602r',
'3397118931',
'3b0498099d',
'3b0807469c',
'51718208483',
'6x1837013c',
'7h0698151',
'802418',
'8200748275',
'826577',
'97189133',
'a6421880580',
'c2512',
'c301302',
'c39219',
'hu7181n',
'p557',
'030115561an',
'03l131547n',
'03l145757h',
'04l131547s',
'58133843',
'13328572522',
'1709059',
'1942046',
'1j0615423g',
'1k0807217egru',
'1z0807221m',
'224018760r',
'2693',
'3b0413031q',
'402102977r',
'4f1837015e',
'5q0615301f',
'620220030r',
'620226857r',
'64193',
'7700712901',
'7701478190',
'7m0412319a',
'8r0133843k',
'95519055',
'a2115401717',
'bech7',
'ct1014k2',
'ct988k2',
'cu8430',
'furtun',
'g12',
'gdb1220',
'hu8152x',
'mb23614',
'n90617501',
'w66',
'w7161',
'032145299a',
'036906262g',
'038103469e',
'038131521cc',
'03l130277b',
'59198405',
'06c133843',
'074115405t',
'1203004',
'1214031',
'1360254',
'1514885',
'165461599r',
'1j0411314r',
'1je821022a',
'1k2945511rdw',
'1z1941017p',
'24152333903',
'3397004632',
'3397007225',
'34116864059',
'34216776937',
'402101554r',
'4b0698451e',
'4h0129620l',
'4h0819439',
'533001710',
'66240',
'6q0411314r',
'6q6955425a',
'7703062072',
'8e0615601p',
'8e0821105b',
'8e0955247',
'8k0857536g',
'a6511800109',
'c27030',
'df2804',
'g055025a2',
'lampa',
'n10591602',
'p999grn',
'ra1829',
'suportnumar',
'w71927',
'wk5010z',
'wk84223x',
'250402005',
'38103663',
'038121011cx',
'03g198119c',
'03g903137e',
'888080845',
'11618507239',
'12972rvs2',
'1373306',
'1376483',
'164000797r',
'1942000',
'1k0411105aq',
'1k6955651',
'1t0955707c',
'1u0837099f',
'24152333907',
'3397007215',
'3b0959781c',
'402063149r',
'620223233r',
'6q0407621br',
'6q0598611',
'6r0698151a',
'7701054752',
'8200216465',
'8200240517',
'8e1823533b01c',
'8k0615601b',
'97189134',
'a001989680311',
'c22952',
'cric',
'n0122942',
'xkb000010',
'032121111ba',
'038121011a',
'038128063l',
'38145345',
'038903315am',
'03g131501e',
'03l130277s',
'76198119',
'11147797490',
'11238511371',
'11428506412',
'1226084',
'1618nr',
'164004ea1b',
'1682737',
'1j0598477',
'1j5943021d',
'1z0823031b',
'2187',
'2195',
'272773016r',
'32590',
'3b5827505m',
'3c9955425',
'415074009',
'51148132375',
'600022800',
'6479c9',
'6pk1590',
'6q0820367b',
'7701206370',
'801016598r',
'8e0807430b',
'c16118',
'c27743kit',
'ct1025k1',
'cu2442',
'gdb2086',
'gs8526',
'jte143',
'p654',
'pfb425',
'vaselina',
'w7032',
'038131501an',
'04l260849c',
'0831v4',
'11127807017',
'13046071102',
'130c17480r',
'13532247156',
'1618hq',
'1708877',
'1j0609721ac',
'1j0821022',
'1j0907660b',
'1j9827025ae',
'1k0121251dm',
'1k0423810a',
'1u0807221k',
'1u0837461b',
'2186',
'2626',
'302057505r',
'311863',
'3aa805588d',
'3b0145805d',
'3c0199231e',
'410601237r',
'52197',
'543a00300r',
'6pk1605',
'7701476476',
'7701478505',
'7e0955425',
'801016190r',
'8200431075',
'8200480127',
'8200682592',
'8d0121251p',
'93196791',
'9672119017',
'97305714',
'97376663',
'cr2016',
'ct867',
'df4276',
'hu831x',
'030103175b',
'038103085e',
'038130073ag',
'03g903315a',
'06a103483d',
'074105251ac',
'077115136a',
'0aw301519c',
'1072246',
'13527797909',
'1441256',
'1447128',
'1508144',
'1618143',
'1j0121253ad',
'1j1422075k',
'1k0201051k',
'1k0498099',
'1k6827505c9b9',
'1u0821105b',
'2289000280',
'2e0601019h',
'3c0941005aa',
'410608481r',
'5g0857521',
'5k0955978a',
'5m0827505h9b9',
'5n0698151',
'5n0965561a',
'6001546784',
'6001549312',
'624315810',
'6n0412331e',
'6q0609617',
'6q0698525a',
'7181',
'7700433414',
'7700500155',
'7701056678',
'8200752683',
'83192211191',
'8e0698451l',
'8e9955985',
'95519058',
'a0009902907',
'c22953',
'c31116',
'ct1136k1',
'cu2842',
'gdb1697',
'h182kit',
'hu618x',
'kl147d',
'manson',
'ox188d',
'wht003187',
'wk9392',
'yt0400',
'030145299f',
'36103677',
'038109119p',
'038903315ae',
'03g198119a',
'11287786075',
'1400303',
'1780195',
'1809256',
'1j1819021c',
'1j6955711g',
'1k0615301aa',
'1k0615601aa',
'210100753r',
'224336134r',
'261500097r',
'334847',
'343348',
'3c0807217dgru',
'3c0819031',
'402069518r',
'415074409',
'4f0698451d',
'53174',
'550207778r',
'5679333',
'6340a3',
'6pk1580',
'6r0615301c',
'713610490',
'713630030',
'713678790',
'7701206905',
'8200371661',
'8200772985',
'8e0698151m',
'8e9945097b',
'9192061',
'a0199970545',
'a6512006000',
'a9064210400',
'bec',
'ct939k2',
'dcrs301110',
'fbx050',
'zse030',
'03c109509p',
'03l198716a',
'115906',
'1201181',
'1201568',
'12105590',
'12217801201',
'130c10474r',
'13143570',
'144609034r',
'164009384r',
'165467751r',
'1698684',
'1743276',
'1776431',
'1942043',
'1j0809962b',
'1j1823533c',
'1k0615301ac',
'1z0821106a',
'1z5807421',
'255408317r',
'34216788183',
'415024110',
'425158',
'490013367r',
'51217202143',
'51777171004',
'530008910',
'55355603',
'5888656b',
'5k0498621',
'5m0827505e',
'620223579r',
'650473',
'6n0412249c',
'6q0411314p',
'6q6827550c',
'703141420',
'7701064235',
'8200074008',
'8200752803',
'8e0819439',
'8k0819439',
'8k0857535f',
'9192425',
'97305715',
'a0019896803',
'a6111800009',
'baterie',
'c17237',
'cu6724',
'cuk3037',
'df4295',
'df4381',
'fp2939',
'g052167m4',
'jtc119',
'lant',
'n10648301',
'p549',
'wht003179',
'036906262j']
    for mfrpn in mfrpns:
        start_urls.append('https://www.epiesa.ro/cautare-piesa/?find=' + mfrpn)
    def __init__(self):
        self.download_delay = 0.2/float(self.rate)

    def parse(self, response):
        for product in response.css('div.single_prd'):
            old_price = product.css('div.col-xs-12')[1].css("b del::text").get()
            yield {
                'name': product.css('h2 a.gg-tag::text').get(),
                'product_url': product.css('div.image_overflow a::attr(href)').extract(),
                'image_url': product.css('div.image_overflow a img::attr(src)').extract(),
                'brand': product.css('p b::text').re(r'Producator: \s*(.*)'),
                'product_mfrpn': product.css('p b::text').re(r'Cod producator: \s*(.*)'),
                'old_price': str(old_price).replace(" Lei", ""),
                'price': product.css('div.col-xs-12')[1].css("b span.red::text").get(),
                'created_at': datetime.now().date(),
            }
